var e=require("react");function t(){}var o=e.createContext(null),r=o.Provider,u=function(e){return e};function n(r){return void 0===r&&(r=o),function(o,n,a){void 0===n&&(n=u),void 0===a&&(a=[]);var s=e.useReducer(function(e){return e+1},0)[1],i=e.useContext(r);if(!i)throw new Error("[reatom] The provider is not defined");var c=e.useRef({store:i,atom:void 0,selector:n,deps:a,atomValue:void 0,selectorValue:void 0,unsubscribe:t,mountStatus:"init"}).current;if(c.selector=n,i!==c.store||o!==c.atom)c.store=i,c.atom=o,c.deps=a,c.unsubscribe(),c.unsubscribe=i.subscribe(c.atom,function(e){if(!Object.is(c.atomValue,e)){c.atomValue=e;var t=c.selector(e);Object.is(t,c.selectorValue)||(c.selectorValue=t,"init"===c.mountStatus?c.mountStatus="outOfDate":s())}}),c.atomValue=c.store.getState(o),c.selectorValue=c.selector(c.atomValue);else{var l=c.store.getState(c.atom);Object.is(l,c.atomValue)&&a.length===c.deps.length&&!a.some(function(e,t){return!Object.is(e,c.deps[t])})||(c.deps=a,c.atomValue=l,c.selectorValue=c.selector(c.atomValue))}return e.useEffect(function(){return"outOfDate"===c.mountStatus&&(c.mountStatus="upToDate",s()),c.mountStatus="upToDate",function(){return c.unsubscribe()}},[]),c.selectorValue}}var a=n();function s(t){return void 0===t&&(t=o),function(o,r){void 0===r&&(r=[]);var u=e.useContext(t);if(!u)throw new Error("[reatom] The provider is not defined");if("function"!=typeof o)throw new TypeError("[reatom] `useAction` argument must be a function");return e.useCallback(function(){var e=o.apply(void 0,[].slice.call(arguments));e&&u.dispatch(e)},r.concat(u))}}var i=s();exports.Provider=r,exports.context=o,exports.createActionHook=s,exports.createAtomHook=n,exports.useAction=i,exports.useAtom=a;
//# sourceMappingURL=index.js.map
